<div class="row">
  <div class="col">
    <div class="row container">
      <div class="col-md-6">
        <h2>ยอดรับซื้อ
        </h2>
      </div>
      <div class="col-md-6">
        <button mat-raised-button color="warn" (click)="onReset()">เคลียร์ยอด</button>
      </div>
    </div>
    <div class="card text-center">
      <p-toast></p-toast>
      <p-table [value]="categories" dataKey="id" editMode="row">
        <ng-template pTemplate="header">
          <tr>
            <th>ประเภท</th>
            <th>ยอดรับซื้อ (บาท)</th>
            <th>ยอดซื้อ (บาท)</th>
            <th>คงเหลือ (บาท)</th>
            <th>แก้ไข</th>
          </tr>
        </ng-template>
        <ng-template
          pTemplate="body"
          let-category
          let-editing="editing"
          let-ri="rowIndex"
        >
          <tr [pEditableRow]="category">
            <td pEditableColumn>
              <p-cellEditor>
                <ng-template pTemplate="input">
                  {{ category.description }}
                </ng-template>
                <ng-template pTemplate="output">
                  {{ category.description }}
                </ng-template>
              </p-cellEditor>
            </td>
            <td>
              <p-cellEditor>
                <ng-template pTemplate="input">
                  <input
                    class="inputText"
                    pInputText
                    type="text"
                    [(ngModel)]="category.purchaseMaximum"
                  />
                </ng-template>
                <ng-template pTemplate="output">
                  {{ category.purchaseMaximum | number: "1.0" }}
                </ng-template>
              </p-cellEditor>
            </td>
            <td>
              <p-cellEditor>
                <ng-template pTemplate="input">
                  {{ category.purchaseAmount }}
                </ng-template>
                <ng-template pTemplate="output">
                  {{ category.purchaseAmount | number: "1.0" }}
                </ng-template>
              </p-cellEditor>
            </td>
            <td>
              <p-cellEditor>
                <ng-template pTemplate="input">
                  {{ category.purchaseBalance }}
                </ng-template>
                <ng-template pTemplate="output">
                  {{ category.purchaseBalance | number: "1.0" }}
                </ng-template>
              </p-cellEditor>
            </td>
            <td style="text-align: center">
              <button
                *ngIf="!editing"
                pButton
                pRipple
                type="button"
                pInitEditableRow
                icon="pi pi-pencil"
                (click)="onRowInitRewardPrice(category)"
                class="p-button-rounded p-button-text"
              ></button>
              <button
                *ngIf="editing"
                pButton
                pRipple
                type="button"
                pSaveEditableRow
                icon="pi pi-check"
                (click)="onRowSavePurchaseMaximum(category)"
                class="p-button-rounded p-button-text p-button-success p-mr-2"
              ></button>
              <button
                *ngIf="editing"
                pButton
                pRipple
                type="button"
                pCancelEditableRow
                icon="pi pi-times"
                (click)="onRowEditRewardPrice(category, ri)"
                class="p-button-rounded p-button-text p-button-danger"
              ></button>
            </td>
          </tr>
        </ng-template>
      </p-table>
    </div>
  </div>

  <div class="col">
    <h1>ตั้งค่ายอดจ่าย</h1>
    <div class="card text-center">
      <p-toast></p-toast>
      <p-table [value]="categories" dataKey="id" editMode="row">
        <ng-template pTemplate="header">
          <tr>
            <th>ประเภท</th>
            <th>ราคาเต็ม (บาทละ)</th>
            <th>ราคาอั้น (บาทละ)</th>
            <th>แก้ไข</th>
          </tr>
        </ng-template>
        <ng-template
          pTemplate="body"
          let-category
          let-editing="editing"
          let-ri="rowIndex"
        >
          <tr [pEditableRow]="category">
            <td>
              <p-cellEditor>
                <ng-template pTemplate="input">
                  {{ category.description }}
                </ng-template>
                <ng-template pTemplate="output">
                  {{ category.description }}
                </ng-template>
              </p-cellEditor>
            </td>
            <td pEditableColumn>
              <p-cellEditor>
                <ng-template pTemplate="input">
                  <input
                    class="inputText"
                    pInputText
                    type="text"
                    [(ngModel)]="category.rewardPrice"
                  />
                </ng-template>
                <ng-template pTemplate="output">
                  {{ category.rewardPrice | number: "1.0" }}
                </ng-template>
              </p-cellEditor>
            </td>
            <td pEditableColumn>
              <p-cellEditor>
                <ng-template pTemplate="input">
                  <input
                    class="inputText"
                    pInputText
                    type="text"
                    [(ngModel)]="category.halfPayReward"
                  />
                </ng-template>
                <ng-template pTemplate="output">
                  {{ category.halfPayReward | number: "1.0" }}
                </ng-template>
              </p-cellEditor>
            </td>
            <td style="text-align: center">
              <button
                *ngIf="!editing"
                pButton
                pRipple
                type="button"
                pInitEditableRow
                icon="pi pi-pencil"
                (click)="onRowInitRewardPrice(category)"
                class="p-button-rounded p-button-text"
              ></button>
              <button
                *ngIf="editing"
                pButton
                pRipple
                type="button"
                pSaveEditableRow
                icon="pi pi-check"
                (click)="onRowSaveRewardPrice(category)"
                class="p-button-rounded p-button-text p-button-success p-mr-2"
              ></button>
              <button
                *ngIf="editing"
                pButton
                pRipple
                type="button"
                pCancelEditableRow
                icon="pi pi-times"
                (click)="onRowEditRewardPrice(category, ri)"
                class="p-button-rounded p-button-text p-button-danger"
              ></button>
            </td>
          </tr>
        </ng-template>
      </p-table>
    </div>
  </div>
</div>
<br />
<mat-divider class="mb-3"></mat-divider>

<div class="row">
  <div class="col-md-6">
    <form (ngSubmit)="onSaveNumber(f)" #f="ngForm" class="row mb-3">
      <h2>เพิ่มเลข</h2>
      <div class="col-md-4">
        <select
          class="form-select form-select-md mb-3"
          aria-label=".form-select-lg example"
          name="id"
          ngModel
        >
          <option selected>ประเภท</option>
          <option *ngFor="let category of categories" [value]="category._id">
            {{ category.description }}
          </option>
        </select>
      </div>
      <div class="col-md-4">
        <input
          type="number"
          class="form-control"
          id="inputNumber"
          placeholder="เลข"
          name="lottoNo"
          ngModel
        />
      </div>
      <div class="col-md-4">
        <button type="submit" class="btn btn-primary mb-3">เพิ่มเลข</button>
      </div>
    </form>
  </div>
  <div class="col-md-6">

      <div class="row container">
        <div class="col-md-6">
          <h2>ตารางเลขอั้น</h2>
        </div>
        <div class="col-md-6">
          <button mat-raised-button color="warn" (click)="onClear()">เคลียร์เลข</button>
        </div>
      </div>
    <div class="list-table mt-3 mb-3" style="height: 40vh">
      <table mat-table [dataSource]="dataSource" class="mat-elevation-z8">
        <ng-container matColumnDef="position">
          <th mat-header-cell *matHeaderCellDef>ลำดับ</th>
          <td mat-cell *matCellDef="let element; let i = index">{{ i + 1 }}</td>
        </ng-container>
        <ng-container matColumnDef="category">
          <th mat-header-cell *matHeaderCellDef>ประเภท</th>
          <td mat-cell *matCellDef="let data">
            {{ data.description }}
          </td>
        </ng-container>
        <ng-container matColumnDef="lottoNo">
          <th mat-header-cell *matHeaderCellDef>เลข</th>
          <td mat-cell *matCellDef="let data">{{ data.halfPay.lottoNo }}</td>
        </ng-container>
        <ng-container matColumnDef="action">
          <th mat-header-cell *matHeaderCellDef></th>
          <td mat-cell *matCellDef="let data">
            <button mat-icon-button color="warn" (click)="onRemoveHalfPay(data._id, data.halfPay._id)">
              <mat-icon class="mat-18">delete</mat-icon>
            </button>
          </td>
        </ng-container>

        <tr mat-header-row *matHeaderRowDef="displayedColumns"></tr>
        <tr mat-row *matRowDef="let row; columns: displayedColumns"></tr>
      </table>
      <mat-paginator
        [pageSizeOptions]="[5]"
        showFirstLastButtons
        aria-label="Select page of periodic elements"
      >
      </mat-paginator>
    </div>
  </div>
</div>
